# 按键绑定

- [按键绑定](#按键绑定)
  - [屏幕滚动](#屏幕滚动)
  - [光标移动](#光标移动)
  - [标签跳转](#标签跳转)
  - [全文搜索](#全文搜索)
  - [快速编辑](#快速编辑)
  - [修改命令](#修改命令)
  - [复制粘贴](#复制粘贴)
  - [语言服务](#语言服务)
  - [文件操作](#文件操作)
  - [窗口操作](#窗口操作)
  - [界面元素](#界面元素)
  - [其他按键或命令](#其他按键或命令)
  - [Markdown](#markdown)

## 屏幕滚动

| 按键                  | 模式         | 动作                   |
| --------------------- | ------------ | ---------------------- |
| `Ctrl`+`D`/`Ctrl`+`U` | **N**, **V** | 向下/上滚半屏          |
| `Ctrl`+`F`/`Ctrl`+`B` | **N**, **V** | 向下/上滚屏            |
| `zz`                  | **N**, **V** | 移动视窗中央到光标位置 |
| `M`                   | **N**, **V** | 移动光标到视窗中央     |

## 光标移动

> Tips: vim 教条——不要在插入模式下执行光标移动操作！

| 按键                      | 模式         | 动作                                           |
| ------------------------- | ------------ | ---------------------------------------------- |
| `h`/`j`/`k`/`l`           | **N**, **V** | 左/下/上/右                                    |
| `w`/`e`/`b`/`ge`          | **N**, **V** | 下个词头/下个词尾/上个词头/上个词尾 (word)     |
| `W`/`E`/`B`/`gE`          | **N**, **V** | 下个词头/下个词尾/上个词头/上个词尾 (WORD)     |
| `0`/`$`                   | **N**, **V** | 行首/行尾                                      |
| `I`/`A`                   | **N**, **V** | 行首/行尾插入                                  |
| `f`+`{char}`/`F`+`{char}` | **N**, **V** | 下/上个字符`{char}`                            |
| `t`+`{char}`/`T`+`{char}` | **N**, **V** | 下/上个字符`{char}`之前/之后                   |
| `;`+`{char1}`+`{char2}`   | **N**, **V** | 选择并跳转到出现连续字符`{char1}{char2}`的位置 |
| `,`                       | **N**, **V** | 选择并跳转到指定的行首                         |
| `%`                       | **N**, **V** | 结对符的另一边                                 |
| `gg`                      | **N**, **V** | 第一行                                         |
| `G`                       | **N**, **V** | 最后一行                                       |
| `{num}`+`G`               | **N**, **V** | 跳转第`{num}`行                                |

## 标签跳转

| 按键                  | 模式  | 动作                            |
| --------------------- | ----- | ------------------------------- |
| `Ctrl`+`O`/`Ctrl`+`I` | **N** | 上/下个跳转表记录的位置         |
| `g;`\|`g,`            | **N** | 上/下个更改表记录的位置         |
| `gi`                  | **N** | 上次插入位置                    |
| `m`+`{char}`          | **N** | 设置 vim 标签                   |
| `'`+`{char}`          | **N** | 跳转 vim 标签                   |
| `mm`                  | **N** | 添加或删除书签                  |
| `mi`                  | **N** | 添加或修改书签注释              |
| `ml`\|`mL`            | **N** | 列出当前文件/所有文件的书签     |
| `mc`\|`mC`            | **N** | 删除当前文件/所有文件的书签     |
| `mp`\|`mn`            | **N** | 上/下一个书签                   |
| `[c`\|`]c`            | **N** | 上/下个 diff change 或 git hunk |

> Tips:
>
> 1. 跳转表以栈结构记录最近的跳转位置，跳转(jump)指那些移动光标数行的操作
> 2. 更改表以队列结构记录最近更改位置

## 全文搜索

| 按键                             | 模式         | 动作                                    |
| -------------------------------- | ------------ | --------------------------------------- |
| `Alt`+`C`                        | **C**        | 搜索时是否大小写敏感                    |
| `Alt`+`W`                        | **C**        | 搜索时是否匹配单词边界                  |
| `Alt`+`R`                        | **C**        | 搜索时是否使用正则语法                  |
| `/`/`?`                          | **N**        | 向下/上搜索                             |
| `*`/`#`                          | **N**, **V** | 向下/上搜索光标下单词（限制单词边界）   |
| `g*`/`g#`                        | **N**        | 向下/上搜索光标下单词（不限制单词边界） |
| `:[range]s/pattern/repl/[flags]` | **C**        | 替换命令                                |
| `g&`                             | **N**        | 对整个文件执行上条替换命令              |
| `Ctrl`+`F`                       | **N**        | 在当前文件中搜索                        |
| `Ctrl`+`H`                       | **N**        | 在当前文件中替换搜索的内容              |
| `Ctrl`+`Shift`+`F`               | **N**, **V** | 在所有文件中搜索内容                    |
| `Ctrl`+`Shift`+`H`               | **N**        | 在所有文件中替换搜索的内容              |

## 快速编辑

| 按键               | 模式         | 动作                     |
| ------------------ | ------------ | ------------------------ |
| `jk`               | **I**        | 退出插入模式             |
| `Ctrl`+`A`         | **I**        | 插入上次插入的文本       |
| `Ctrl`+`O`         | **I**        | 临时执行一次普通模式指令 |
| `Ctrl`+`D`         | **I**        | 左移本行                 |
| `Ctrl`+`T`         | **I**        | 右移本行                 |
| `<`                | **N**, **V** | 左移本行                 |
| `>`                | **N**, **V** | 右移本行                 |
| `Ctrl`+`Shift`+`J` | **N**, **I** | 下移本行                 |
| `Ctrl`+`Shift`+`K` | **N**, **I** | 上移本行                 |
| `Ctrl`+`J`         | **N**, **I** | 在下面新增空行           |
| `Ctrl`+`H`         | **I**        | 删除光标前字符           |
| `Ctrl`+`W`         | **I**        | 删除光标前单词           |
| `Ctrl`+`U`         | **I**        | 删除光标前至行首所有内容 |
| `Ctrl`+`K`         | **I**        | 删除光标后至行末所有内容 |
| `Ctrl`+`L`         | **I**        | 光标右移一个单词         |
| `Alt`+`E`          | **I**        | 将光标右的字符右移       |
| `Ctrl`+`Z`         | **I**        | 撤销                     |
| `Ctrl`+`Shift`+`Z` | **I**        | 重做                     |
| `u`                | **N**        | 撤销                     |
| `Ctrl`+`R`         | **N**        | 重做                     |
| `Ctrl`+`N`         | **N**, **V** | 选中下个匹配词并添加光标 |
| `Ctrl`+`Shift`+`N` | **N**, **V** | 选中上个匹配词并添加光标 |
| `Ctrl`+`Shift`+`L` | **N**, **V** | 选中所有匹配词并添加光标 |

> Tips:
>
> 1. vscode 中的撤销与重做操作使用的是 vim 的更改栈，所以对于执行撤销操作会被 vscode 当做是更改操作（将更改压栈记录）
> 2. vim 多光标编辑使用插件 [vim-visual-multi](https://github.com/mg979/vim-visual-multi)

## 修改命令

| 按键                           | 模式  | 动作                         |
| ------------------------------ | ----- | ---------------------------- |
| `~`                            | **N** | 反转光标下字符大小写         |
| `r`                            | **N** | 替换光标下字符               |
| `x`                            | **N** | 删除光标下字符               |
| `s`                            | **N** | 删除光标下字符并进入插入模式 |
| `R`                            | **N** | 替换直到退出                 |
| `D`                            | **N** | 删除直到行尾                 |
| `C`                            | **N** | 删除直到行尾并进入插入模式   |
| `dd`                           | **N** | 删除当前行                   |
| `cc`                           | **N** | 删除当前行并进入插入模式     |
| `ds`+`{char}`                  | **N** | 删除包围符                   |
| `cs`+`{old-char}`+`{new-char}` | **N** | 替换包围符                   |
| `ys`+`{text-obj}`+`{char}`     | **N** | 添加包围符                   |
| `J`                            | **N** | 连接下行至本行               |
| `S`                            | **N** | 从光标处断开到下行           |
| `Ctrl`+`A`/`Ctrl`+`X`          | **N** | 递增/减光标下数字            |
| `.`                            | **N** | 重复上次修改操作             |
| `q`+`{reg}`                    | **N** | 宏录制                       |
| `@`+`{reg}`                    | **N** | 应用宏                       |
| `@@`                           | **N** | 应用上次宏                   |

> Tips:
>
> - 复合操作符：`v` `y` `d` `c` `gu` `gU` `g~`
> - 文本对象： `w` `W` `(` `{` `[` `<` `"` `'` `` ` `` `%` `e` `l` `i` `f` `,`
> - 复合操作：
>   - **[次数 +] 普通操作符**，如`3x`将删除光标下字符 3 次
>   - **复合操作符 + [次数 +] 光标移动**，如`dt(`将删除光标下字符直到第一个`(`之前的所有字符
>   - **复合操作符 + 文本对象**，如`yi"`将复制包含光标所在位置在内的两个`"`之间的所有字符

## 复制粘贴

| 按键                            | 模式         | 动作                                      |
| ------------------------------- | ------------ | ----------------------------------------- |
| `"`+`{reg}`+`y`                 | **N**, **V** | 复制到`{reg}`寄存器                       |
| `"`+`{reg}`+`p`/`"`+`{reg}`+`P` | **N**, **V** | 粘贴`{reg}`寄存器到光标之后/之前          |
| `Ctrl`+`R`+`{reg}`              | **I**        | 粘贴`{reg}`寄存器                         |
| `Ctrl`+`V`                      | **I**        | 粘贴系统剪切板（`+` 寄存器）              |
| `p`/`P`                         | **N**        | 粘贴上次复制内容到光标后/前（`"` 寄存器） |
| `y`                             | **N**, **V** | 复制到 `0` 寄存器                         |
| `yy`                            | **N**        | 复制本行到 `0` 寄存器                     |
| `zp`/`zP`                       | **N**, **V** | 粘贴 `0` 寄存器到光标后/前                |
| `zo`/`zO`                       | **N**        | 粘贴 `0` 寄存器到下/上行                  |
| `zg`                            | **N**        | 将 `0` 寄存器内容复制到 `+` 寄存器        |
| `gy`                            | **N**, **V** | 复制到系统剪切板（`+` 寄存器）            |
| `gyy`                           | **N**        | 复制本行到系统剪切板（`+` 寄存器）        |
| `gp`/`gP`                       | **N**, **V** | 粘贴系统剪切板到光标后/前                 |
| `go`/`gO`                       | **N**        | 粘贴系统剪切板到下/上行                   |
| `Space`+`by`                    | **N**        | 复制当前文件所有内容到系统剪切板          |
| `Space`+`bp`                    | **N**        | 粘贴系统剪切板覆盖当前文件所有内容        |

> Tips:
>
> - `d`, `x`, `y`, `p`(visual) 操作符都会覆盖 `"` 寄存器（`c`, `s` 被配置为不会覆盖）
> - `y` 会将复制的内容压入数字寄存器，最新的复制内容在`0`寄存器，最旧的在`9`

## 语言服务

| 按键               | 模式                | 动作                                           |
| ------------------ | ------------------- | ---------------------------------------------- |
| `Ctrl`+`I`         | **I**               | 手动开关补全列表                               |
| `Ctrl`+`N`         | **I**               | 下个补全项                                     |
| `Ctrl`+`P`         | **I**               | 上个补全项                                     |
| `Tab`              | **I**               | 选中补全项，或展开代码片段，或跳转下个片段锚点 |
| `Alt`+`I`          | **N**, **I**, **V** | 搜索可用代码片段                               |
| `Alt`+`Shift`+`F`  | **N**, **I**, **V** | 格式化文本                                     |
| `F2`               | **N**               | 重命名符号                                     |
| `Ctrl`+`.`         | **N**               | 代码动作                                       |
| `Ctrl`+`/`         | **N**               | 注释本行代码                                   |
| `Ctrl`+`Shift`+`O` | **N**               | 搜索本地标签                                   |
| `Ctrl`+`T`         | **N**               | 搜索全局标签                                   |
| `gd`               | **N**               | 跳转定义或声明                                 |
| `gr`               | **N**               | 跳转引用                                       |
| `gI`               | **N**               | 跳转实现                                       |
| `K`                | **N**               | 触发悬停信息                                   |
| `[d`/`]d`          | **N**               | 跳转上/下个诊断问题                            |

> Tips: vim 中 `Ctrl`+`.` 按键通常无效，此时可用 `Alt`+`.` 做替代

## 文件操作

| 按键                  | 模式  | 动作               |
| --------------------- | ----- | ------------------ |
| `H`/`L`               | **N** | 切换上/下一个文件  |
| `Ctrl`+`Tab`          | **N** | 快速切换文件       |
| `Ctrl`+`K` `Ctrl`+`O` | **N** | 打开目录           |
| `Ctrl`+`K` `o`        | **N** | 打开文件           |
| `Ctrl`+`K` `n`        | **N** | 新建文件           |
| `Ctrl`+`K` `r`        | **N** | 搜索最近访问文件   |
| `Ctrl`+`P`            | **N** | 搜索项目文件       |
| `Ctrl`+`S`            | **N** | 保存               |
| `Ctrl`+`Shift`+`S`    | **N** | 另存为             |
| `Ctrl`+`K` `s`        | **N** | 保存所有           |
| `Ctrl`+`Shift`+`W`    | **N** | 关闭当前文件       |
| `Ctrl`+`Shift`+`T`    | **N** | 重开关闭的 Editor  |
| `Ctrl`+`K` `u`        | **N** | 关闭组中已保存文件 |
| `Ctrl`+`K` `w`        | **N** | 关闭组中所有文件   |
| `Ctrl`+`K` `Ctrl`+`W` | **N** | 关闭所有文件       |

> Tips: vim 中关于 buffer 的操作按键前缀为 `Space`+`b`

## 窗口操作

| 按键                   | 模式  | 动作                                       |
| ---------------------- | ----- | ------------------------------------------ |
| `Tab`/`Shift`+`Tab`    | **N** | 跳转下/上个窗口                            |
| `Ctrl`+`{1~8}`         | **N** | 跳转第 1~8 个窗口                          |
| `Ctrl`+`W` `h`         | **N** | 跳转左边的窗口，其他方向同理               |
| `Ctrl`+`W` `Shift`+`H` | **N** | 将当前窗口与左边窗口交换位置，其他方向同理 |
| `Ctrl`+`W` `=`         | **N** | 均布窗口大小                               |
| `Ctrl`+`W` `v`         | **N** | 竖直切分                                   |
| `Ctrl`+`W` `s`         | **N** | 水平切分                                   |
| `Ctrl`+`W` `o`         | **N** | 仅保留当前窗口                             |

## 界面元素

| 按键               | 模式  | 动作         |
| ------------------ | ----- | ------------ |
| `F1`               | **N** | Side Bar     |
| `Ctrl`+`Shift`+`E` | **N** | Explorer     |
| `Ctrl`+`Shift`+`G` | **N** | Git          |
| `Ctrl`+`Shift`+`D` | **N** | Debugger     |
| `Ctrl`+`Shift`+`M` | **N** | Problem      |
| `Ctrl`+`Shift`+`U` | **N** | Output       |
| `Ctrl`+`Shift`+`Y` | **N** | Debug Consol |
| `Ctrl`+`` ` ``     | **N** | Terminal     |

## 其他按键或命令

| 按键               | 模式        | 动作                       |
| ------------------ | ----------- | -------------------------- |
| `ga`               | **N**       | 查看 unicode 码点          |
| `g8`               | **N**       | 查看 utf-8 编码            |
| `za`               | **N**       | 切换折叠                   |
| `Alt`+`Z`          | **N**       | 是否长行回绕               |
| `Alt`+`E`          | **N**       | 在 Explorer 中打开文件目录 |
| `Alt`+`T`          | **N**       | 切换鼠标悬停翻译           |
| `Ctrl`+`Shift`+`P` | **N**       | 搜索命令                   |
| Calculator         | vscode 命令 | 计算器                     |
| VSCodeCounter      | vscode 命令 | 项目代码统计               |

## Markdown

| 按键               | 模式  | 动作                      |
| ------------------ | ----- | ------------------------- |
| `Ctrl`+`Shift`+`V` | **N** | Markdown 预览（当前窗口） |
| `Ctrl`+`K` `V`     | **N** | Markdown 预览（切分窗口） |
| `Ctrl`+`Shift`+`]` | **N** | 标题(uplevel)             |
| `Ctrl`+`Shift`+`[` | **N** | 标题(downlevel)           |
| `Ctrl`+`B`         | **N** | 粗体                      |
| `Ctrl`+`I`         | **N** | 斜体                      |
| `Alt`+`C`          | **N** | 确认 task                 |
| `Alt`+`Ctrl`+`V`   | **N** | 粘贴图片                  |
